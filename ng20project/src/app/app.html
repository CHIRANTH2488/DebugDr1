<div class="container-fluid">
  <nav class="navbar navbar-expand-lg navbar-light bg-light mb-3">
    <a class="navbar-brand" href="#" (click)="goToHome()">Debugging Doctors</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <div class="navbar-nav">
        <a class="nav-link" *ngIf="!authService.isLoggedIn()" (click)="goToHome()">Home</a>
        <a class="nav-link" *ngIf="!authService.isLoggedIn()" (click)="goToLogin()">Login</a>
        <a class="nav-link" *ngIf="!authService.isLoggedIn()" (click)="goToRegister()">Register</a>
        <a class="nav-link" *ngIf="authService.isLoggedIn()" (click)="goToDashboard()">Dashboard</a>
        <a class="nav-link" *ngIf="authService.isLoggedIn()" (click)="logout()">Logout</a>
      </div>
    </div>
  </nav>

  <ng-container *ngIf="!authService.isLoggedIn(); else loggedInContent">
    <div class="text-center mt-5" *ngIf="currentView === 'home'">
      <h1>Welcome to Debugging Doctors</h1>
      <p>Your trusted healthcare provider. Book appointments, manage prescriptions, and more.</p>
      <button class="btn btn-primary me-2" (click)="goToLogin()">Login</button>
      <button class="btn btn-secondary" (click)="goToRegister()">Register</button>
    </div>
    <app-main-portal *ngIf="currentView === 'main'" (viewChange)="setView($event)"></app-main-portal>
    <app-about *ngIf="currentView === 'about'"></app-about>
    <app-vision *ngIf="currentView === 'vision'"></app-vision>
    <app-our-doctors *ngIf="currentView === 'doctors'"></app-our-doctors>
    <app-login *ngIf="currentView === 'login'"></app-login>
    <app-register *ngIf="currentView === 'register'"></app-register>
  </ng-container>

  <ng-template #loggedInContent>
    <ng-container [ngSwitch]="authService.getRole()">
      <div *ngSwitchCase="'Admin'">
        <app-admin-navbar (viewChange)="setView($event)"></app-admin-navbar>
        <app-admin-dashboard *ngIf="currentView === 'dashboard'"></app-admin-dashboard>
        <app-doctor-requests *ngIf="currentView === 'doctor-requests'"></app-doctor-requests>
        <app-patient-requests *ngIf="currentView === 'patient-requests'"></app-patient-requests>
        <app-doctor-list *ngIf="currentView === 'doctor-list'"></app-doctor-list>
        <app-patient-list *ngIf="currentView === 'patient-list'"></app-patient-list>
        <app-appointment-ongoing *ngIf="currentView === 'appointment-ongoing'"></app-appointment-ongoing>
        <app-appointment-upcoming *ngIf="currentView === 'appointment-upcoming'"></app-appointment-upcoming>
        <app-appointment-finished *ngIf="currentView === 'appointment-finished'"></app-appointment-finished>
      </div>
      <div *ngSwitchCase="'Doctor'">
        <app-doctor-navbar (viewChange)="setView($event)"></app-doctor-navbar>
        <app-doctor-dashboard *ngIf="currentView === 'dashboard'"></app-doctor-dashboard>
        <app-doctor-details *ngIf="currentView === 'details'"></app-doctor-details>
        <app-appointment-upcoming *ngIf="currentView === 'appointment-upcoming'"></app-appointment-upcoming>
        <app-appointment-ongoing *ngIf="currentView === 'appointment-ongoing'"></app-appointment-ongoing>
        <app-appointment-history *ngIf="currentView === 'appointment-history'"></app-appointment-history>
        <app-prescription-form *ngIf="currentView === 'prescription-form'"></app-prescription-form>
        <app-invoice-form *ngIf="currentView === 'invoice-form'"></app-invoice-form>
        <app-download-pdf *ngIf="currentView === 'download-pdf'"></app-download-pdf>
      </div>
      <div *ngSwitchCase="'Patient'">
        <app-patient-navbar (viewChange)="setView($event)"></app-patient-navbar>
        <app-patient-dashboard *ngIf="currentView === 'dashboard'"></app-patient-dashboard>
        <app-patient-details *ngIf="currentView === 'details'"></app-patient-details>
        <app-book-appointment *ngIf="currentView === 'book-appointment'"></app-book-appointment>
        <app-cancel-appointment *ngIf="currentView === 'cancel-appointment'"></app-cancel-appointment>
        <app-appointment-upcoming *ngIf="currentView === 'appointment-upcoming'"></app-appointment-upcoming>
        <app-appointment-ongoing *ngIf="currentView === 'appointment-ongoing'"></app-appointment-ongoing>
        <app-appointment-history *ngIf="currentView === 'appointment-history'"></app-appointment-history>
      </div>
      <div *ngSwitchDefault>
        <p class="text-danger">Invalid Role. Please log in again.</p>
        <button class="btn btn-danger mt-3" (click)="logout()">Logout</button>
      </div>
    </ng-container>
  </ng-template>
</div>